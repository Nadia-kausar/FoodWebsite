<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Confirm Order | Online Food Delivery</title>
  <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="css/font-awesome/css/font-awesome.css" />
  <link rel="stylesheet" href="css/hover-min.css" />
  <link rel="stylesheet" href="css/style.css" />

  <style>
    /* === CART DROPDOWN === */
    .cart-content {
      display: none;
      position: absolute;
      right: 10px;
      top: 50px;
      width: 400px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      z-index: 100;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .shopping-cart:hover + .cart-content,
    .cart-content:hover {
      display: block;
    }
    .cart-table img {
      width: 50px;
      border-radius: 5px;
    }

    /* === LIGHT DELETE BUTTON === */
    .btn-delete {
      color: #999; /* soft gray */
      font-weight: bold;
      text-decoration: none;
      cursor: pointer;
      transition: color 0.3s ease, transform 0.2s ease;
    }
    .btn-delete:hover {
      color: #ff6b6b; /* coral red */
      transform: scale(1.2);
    }
  </style>
</head>
<body>
  <script>
    // ✅ Redirect if not logged in
    if (!localStorage.getItem('isLoggedIn')) {
      window.location.href = 'login.html';
    }
  </script>

  <!-- ===== HEADER ===== -->
  <header class="navbar">
    <nav id="site-top-nav" class="navbar-menu navbar-fixed-top">
      <div class="container">
        <div class="logo">
          <a href="index.html"><img src="img/logo.png" alt="Logo" class="img-responsive" /></a>
        </div>
        <div class="menu text-right">
          <ul>
            <li><a href="index.html" class="hvr-underline-from-center">Home</a></li>
            <li><a href="categories.html" class="hvr-underline-from-center">Categories</a></li>
            <li><a href="foods.html" class="hvr-underline-from-center">Foods</a></li>
            <li><a href="order.html" class="hvr-underline-from-center active">Order</a></li>
            <li><a href="contact.html" class="hvr-underline-from-center">Contact</a></li>
            <li><a href="#" id="logout-btn" class="hvr-underline-from-center">Logout</a></li>
            <li>
              <a id="shopping-cart" class="shopping-cart">
                <i class="fa fa-cart-arrow-down"></i>
                <span class="badge">0</span>
              </a>
              <div id="cart-content" class="cart-content">
                <h3 class="text-center">Shopping Cart</h3>
                <table class="cart-table" border="0" width="100%">
                  <thead>
                    <tr>
                      <th>Food</th><th>Name</th><th>Price</th><th>Qty</th><th>Total</th><th>Action</th>
                    </tr>
                  </thead>
                  <tbody id="cart-body"><tr><td colspan="6" class="text-center">Cart is empty</td></tr></tbody>
                  <tfoot><tr><th colspan="4">Total</th><th id="cart-total">$0.00</th><th></th></tr></tfoot>
                </table>
                <a href="order.html" class="btn-primary">Confirm Order</a>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <!-- ===== ORDER SECTION ===== -->
  <section class="order">
    <div class="container">
      <h2 class="text-center">Fill this form to confirm your order.</h2>
      <table class="tbl-full" border="0">
        <thead>
          <tr>
            <th>S.N.</th><th>Food</th><th>Name</th><th>Price</th><th>Qty</th><th>Total</th><th>Action</th>
          </tr>
        </thead>
        <tbody id="order-table-body">
          <tr><td colspan="7" class="text-center">Your cart is empty.</td></tr>
        </tbody>
        <tfoot>
          <tr><th colspan="5">Total</th><th id="order-total">$0.00</th><th></th></tr>
        </tfoot>
      </table>

      <form id="order-form" class="form">
        <fieldset>
          <legend>Delivery Details</legend>
          <p class="label">Full Name</p>
          <input type="text" id="fullname" placeholder="Enter your name..." required />
          <p class="label">Phone Number</p>
          <input type="text" id="phone" placeholder="Enter your phone..." required />
          <p class="label">Email</p>
          <input type="email" id="email" placeholder="Enter your email..." required />
          <p class="label">Address</p>
          <input type="text" id="address" placeholder="Enter your address..." required />
          <input type="submit" value="Confirm Order" class="btn-primary" />
        </fieldset>
      </form>
    </div>
  </section>

  <!-- ===== FOOTER ===== -->
  <section class="footer">
    <div class="container">
      <div class="grid-3">
        <div class="text-center">
          <h3>About Us</h3><br>
          <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Placeat officia, temporibus expedita dicta eligendi harum architecto fugiat sint.</p>
        </div>
        <div class="text-center">
          <h3>Site Map</h3><br>
          <div class="site-links">
            <a href="categories.html">Categories</a>
            <a href="foods.html">Foods</a>
            <a href="order.html">Order</a>
            <a href="contact.html">Contact</a>
            <a href="login.html">Login</a>
          </div>
        </div>
        <div class="social-links text-center">
          <h3>Social Links</h3><br>
          <div class="social">
            <ul>
              <li><a href="#"><img src="https://img.icons8.com/color/48/facebook-new.png" /></a></li>
              <li><a href="#"><img src="https://img.icons8.com/fluency/48/instagram-new.png" /></a></li>
              <li><a href="#"><img src="https://img.icons8.com/color/48/twitter--v1.png" /></a></li>
              <li><a href="#"><img src="https://img.icons8.com/color/48/linkedin-circled--v1.png" /></a></li>
              <li><a href="#"><img src="https://img.icons8.com/color/48/youtube-play.png" /></a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== COPYRIGHT ===== -->
  <section class="copyright">
    <div class="container text-center">
      <p>All rights reserved. Design By <a href="#">Nadia Kausar</a></p>
    </div>
  </section>

  <!-- ===== JS: CART + ORDER + LOGOUT ===== -->
  <script>
    // ✅ Logout functionality
    document.getElementById('logout-btn').addEventListener('click', () => {
      localStorage.removeItem('isLoggedIn');
      localStorage.removeItem('userEmail');
      alert('Logged out successfully.');
      window.location.href = 'login.html';
    });

    // ✅ Load cart data
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const badge = document.querySelector('.badge');
    const cartBody = document.getElementById('cart-body');
    const cartTotal = document.getElementById('cart-total');
    const orderTableBody = document.getElementById('order-table-body');
    const orderTotal = document.getElementById('order-total');

    function updateCartDisplay() {
      let total = 0;
      cartBody.innerHTML = '';
      orderTableBody.innerHTML = '';

      if (cart.length === 0) {
        cartBody.innerHTML = '<tr><td colspan="6" class="text-center">Cart is empty</td></tr>';
        orderTableBody.innerHTML = '<tr><td colspan="7" class="text-center">Your cart is empty.</td></tr>';
      } else {
        cart.forEach((item, index) => {
          const totalPrice = (item.price * item.qty).toFixed(2);
          total += parseFloat(totalPrice);

          // Cart dropdown
          cartBody.innerHTML += `
            <tr>
              <td><img src="${item.image}" width="50"></td>
              <td>${item.name}</td>
              <td>$${item.price.toFixed(2)}</td>
              <td>${item.qty}</td>
              <td>$${totalPrice}</td>
              <td><a href="#" class="btn-delete" data-index="${index}">&times;</a></td>
            </tr>
          `;

          // Order table
          orderTableBody.innerHTML += `
            <tr>
              <td>${index + 1}</td>
              <td><img src="${item.image}" width="50"></td>
              <td>${item.name}</td>
              <td>$${item.price.toFixed(2)}</td>
              <td>${item.qty}</td>
              <td>$${totalPrice}</td>
              <td><a href="#" class="btn-delete" data-index="${index}">&times;</a></td>
            </tr>
          `;
        });
      }

      cartTotal.textContent = '$' + total.toFixed(2);
      orderTotal.textContent = '$' + total.toFixed(2);
      badge.textContent = cart.length;
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    // ✅ Remove item
    document.body.addEventListener('click', e => {
      if (e.target.classList.contains('btn-delete')) {
        const index = e.target.dataset.index;
        cart.splice(index, 1);
        updateCartDisplay();
      }
    });

    // ✅ Handle order submission
    document.getElementById('order-form').addEventListener('submit', function (e) {
      e.preventDefault();
      if (cart.length === 0) {
        alert('Your cart is empty. Please add items first.');
        return;
      }

      const orderData = {
        name: document.getElementById('fullname').value,
        phone: document.getElementById('phone').value,
        email: document.getElementById('email').value,
        address: document.getElementById('address').value,
        cart: cart,
        total: document.getElementById('order-total').textContent
      };

      alert('Order confirmed successfully! Thank you, ' + orderData.name + '.');
      localStorage.removeItem('cart');
      updateCartDisplay();
      document.getElementById('order-form').reset();
    });

    updateCartDisplay();
  </script>
</body>
</html>
